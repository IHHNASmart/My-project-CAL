OBJECT Page 50003 Out of Office Requests List
{
  OBJECT-PROPERTIES
  {
    Date=10.06.22;
    Time=16:38:25;
    Modified=Yes;
    Version List=;
  }
  PROPERTIES
  {
    Editable=No;
    CaptionML=[ENU=Out of Office Requests;
               RUS=Заявки на отсутствие];
    SourceTable=Table50002;
    PageType=List;
    CardPageID=Out of Office Request Doc;
    ActionList=ACTIONS
    {
      { 14      ;    ;ActionContainer;
                      CaptionML=ENU=General;
                      ActionContainerType=ActionItems }
      { 15      ;1   ;Action    ;
                      Name=Start process;
                      CaptionML=[ENU=Start process;
                                 RUS=Начать процесс];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      PromotedCategory=Process;
                      PromotedOnly=Yes;
                      OnAction=BEGIN

                                   //'In process';
                                   IF CONFIRM(textSet, FALSE, FORMAT(xRec.Status::"In process")) THEN
                                     SetNewStatus(xRec.Status::"In process",'');

                               END;
                                }
      { 16      ;1   ;Action    ;
                      Name=Approve;
                      CaptionML=[ENU=Approve;
                                 RUS=Утвердить];
                      Promoted=Yes;
                      PromotedCategory=Process;
                      PromotedOnly=Yes;
                      OnAction=BEGIN

                                   //'Approved';
                                   IF CONFIRM(textSet, FALSE, FORMAT(xRec.Status::Approved)) THEN
                                     SetNewStatus(xRec.Status::Approved,'');

                               END;
                                }
      { 17      ;1   ;Action    ;
                      Name=Decline;
                      CaptionML=[ENU=Decline;
                                 RUS=Отклонить];
                      Promoted=Yes;
                      PromotedCategory=Process;
                      PromotedOnly=Yes;
                      OnAction=BEGIN

                                   CLEAR(dialConfirmationRejected);
                                   //'Declined';
                                   dialConfirmationRejected.SetVariablesPage(FORMAT(xRec.Status::Declined));

                                   IF dialConfirmationRejected.RUNMODAL = ACTION::OK THEN
                                     SetNewStatus(xRec.Status::Declined, dialConfirmationRejected.GetVariablePage);
                               END;
                                }
      { 18      ;    ;ActionContainer;
                      ActionContainerType=Reports }
      { 19      ;1   ;Action    ;
                      Name=Print Out of Office Day Count;
                      CaptionML=[ENU=Print Out of Office Day Count;
                                 RUS=Печать кол-во дней отсутствия];
                      RunObject=Report 50000 }
    }
  }
  CONTROLS
  {
    { 1   ;0   ;Container ;
                ContainerType=ContentArea }

    { 2   ;1   ;Group     ;
                Name=Group;
                GroupType=Repeater }

    { 3   ;2   ;Field     ;
                SourceExpr="Entry No" }

    { 4   ;2   ;Field     ;
                SourceExpr="Employee No." }

    { 5   ;2   ;Field     ;
                SourceExpr="Start Date" }

    { 6   ;2   ;Field     ;
                SourceExpr="Start Time" }

    { 7   ;2   ;Field     ;
                SourceExpr="End Date" }

    { 8   ;2   ;Field     ;
                SourceExpr="End Time" }

    { 9   ;2   ;Field     ;
                SourceExpr="Reason Code" }

    { 13  ;2   ;Field     ;
                SourceExpr=ReasonName }

    { 10  ;2   ;Field     ;
                SourceExpr=Status }

    { 11  ;2   ;Field     ;
                SourceExpr=Description }

    { 12  ;2   ;Field     ;
                SourceExpr="Rejection reason" }

  }
  CODE
  {
    VAR
      textSet@1000 : TextConst 'ENU=Change status to "%1"?;RUS=Изменить статус на "%1"?';
      dialConfirmationRejected@1001 : Page 50005;

    LOCAL PROCEDURE SetNewStatus@1(NewStatus@1000 : Option;TextStatus@1003 : Text[250]);
    VAR
      OutOfOfficeRequest@1001 : Record 50002;
      text001@1002 : TextConst 'ENU=Status set "%1";RUS=Установлен статус "%1"';
    BEGIN

          CLEAR(OutOfOfficeRequest);

          OutOfOfficeRequest.GET(xRec."Entry No");
          OutOfOfficeRequest.Status := NewStatus;

          IF NewStatus = OutOfOfficeRequest.Status::Declined THEN
            OutOfOfficeRequest."Rejection reason" := TextStatus
          ELSE
            OutOfOfficeRequest."Rejection reason" := '';

          OutOfOfficeRequest.MODIFY;

          MESSAGE(text001, OutOfOfficeRequest.Status);

    END;

    BEGIN
    END.
  }
}

