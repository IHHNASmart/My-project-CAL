OBJECT Table 50002 Out of Office Request
{
  OBJECT-PROPERTIES
  {
    Date=12.06.22;
    Time=21:08:04;
    Modified=Yes;
    Version List=;
  }
  PROPERTIES
  {
    DataCaptionFields=Entry No,Employee No.,Status;
    OnInsert=BEGIN

                 "Entry No CODE" := 1;
             END;

    OnModify=BEGIN

                 TESTFIELD("Employee No.");
                 TESTFIELD("Reason Code");
                 TESTFIELD("Start Date");
                 TESTFIELD("Start Time");
                 TESTFIELD("End Date");
                 TESTFIELD("End Time");
                 TESTFIELD(Description);

                 "Entry No CODE" := 1;
             END;

    OnRename=BEGIN

                 "Entry No CODE" := 1;
             END;

    DataClassification=CustomerContent;
    CaptionML=[ENU=Out of Office Request;
               RUS=Заявка на отсутствие;
               UKR=Заявка на в▄дсутн▄сть];
    LookupPageID=Page50003;
    DrillDownPageID=Page50004;
  }
  FIELDS
  {
    { 1   ;   ;Entry No            ;Integer       ;AutoIncrement=Yes;
                                                   DataClassification=CustomerContent;
                                                   CaptionML=[ENU=Entry No;
                                                              RUS=Номер];
                                                   NotBlank=No }
    { 2   ;   ;Employee No.        ;Code20        ;TableRelation=Employee;
                                                   DataClassification=CustomerContent;
                                                   CaptionML=[ENU=Employee No.;
                                                              RUS=Код сотрудника] }
    { 3   ;   ;Start Date          ;Date          ;OnValidate=BEGIN

                                                                   IF "Start Date" > "End Date" THEN
                                                                      FIELDERROR("Start Date", textError01);

                                                                  IF "Start Date" < WORKDATE THEN
                                                                      FIELDERROR("Start Date", textError03);
                                                              END;

                                                   DataClassification=CustomerContent;
                                                   CaptionML=[ENU=Start Date;
                                                              RUS=Дата начала];
                                                   NotBlank=Yes }
    { 4   ;   ;Start Time          ;Time          ;InitValue=[ 9:00:00];
                                                   OnValidate=BEGIN

                                                                  IF "Start Time" >= "End Time" THEN
                                                                    FIELDERROR("Start Time",textError02);
                                                              END;

                                                   DataClassification=CustomerContent;
                                                   CaptionML=[ENU=Start Time;
                                                              RUS=Время начала];
                                                   NotBlank=Yes }
    { 5   ;   ;End Date            ;Date          ;OnValidate=BEGIN

                                                                  IF "Start Date" > "End Date" THEN
                                                                      FIELDERROR("End Date", textError01);
                                                              END;

                                                   DataClassification=CustomerContent;
                                                   CaptionML=[ENU=End Date;
                                                              RUS=Дата конца];
                                                   NotBlank=Yes }
    { 6   ;   ;End Time            ;Time          ;InitValue=18:00:00;
                                                   OnValidate=BEGIN

                                                                  IF "Start Time" >= "End Time" THEN
                                                                    FIELDERROR("End Time",textError02);
                                                              END;

                                                   DataClassification=CustomerContent;
                                                   CaptionML=[ENU=End Time;
                                                              RUS=Время конца];
                                                   NotBlank=Yes }
    { 7   ;   ;Reason Code         ;Code20        ;TableRelation="Out of Office Reason";
                                                   DataClassification=CustomerContent;
                                                   CaptionML=[ENU=Reason Code;
                                                              RUS=Код причины];
                                                   NotBlank=Yes }
    { 8   ;   ;Status              ;Option        ;InitValue=New;
                                                   DataClassification=CustomerContent;
                                                   CaptionML=[ENU=Status;
                                                              RUS=Статус];
                                                   OptionCaptionML=[ENU=New,In process,Approved,Declined;
                                                                    RUS=Новая,На рассмотрении,Утверждено,Отклонено];
                                                   OptionString=New,In process,Approved,Declined;
                                                   Editable=No }
    { 9   ;   ;Description         ;Text250       ;DataClassification=CustomerContent;
                                                   CaptionML=[ENU=Description;
                                                              RUS="Описание причины отсутствия "];
                                                   NotBlank=Yes }
    { 10  ;   ;Rejection reason    ;Text250       ;DataClassification=CustomerContent;
                                                   CaptionML=[ENU=Rejection reason;
                                                              RUS=Описание причины отказа] }
    { 11  ;   ;Entry No CODE       ;Integer       ;DataClassification=ToBeClassified }
    { 1002;   ;EmployeeInitials    ;Text50        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup(Employee.Initials WHERE (No.=FIELD(Employee No.)));
                                                   CaptionML=[ENU=Employee Initials;
                                                              RUS=Initials сотрудника] }
    { 1007;   ;ReasonName          ;Text50        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup("Out of Office Reason".Description WHERE (Code=FIELD(Reason Code)));
                                                   CaptionML=[ENU=Reason Name;
                                                              RUS=Название причины] }
    { 1010;   ;AllRequests         ;Integer       ;FieldClass=FlowField;
                                                   CalcFormula=Count("Out of Office Request") }
    { 1011;   ;AllRequests New     ;Integer       ;FieldClass=FlowField;
                                                   CalcFormula=Count("Out of Office Request" WHERE (Status=FILTER(New))) }
    { 1012;   ;AllRequests In process;Integer     ;FieldClass=FlowField;
                                                   CalcFormula=Count("Out of Office Request" WHERE (Status=FILTER(In process))) }
  }
  KEYS
  {
    {    ;Entry No                                ;Clustered=Yes }
    {    ;Employee No.                             }
    {    ;Reason Code                              }
    {    ;Status                                   }
  }
  FIELDGROUPS
  {
    { 1   ;Brick               ;Employee No.,Entry No,Reason Code        }
    { 2   ;DropDown            ;Employee No.,Entry No,Reason Code        }
    { 3   ;test                ;Entry No,Employee No.,Status,ReasonName  }
  }
  CODE
  {
    VAR
      textError01@1000 : TextConst 'ENU=" must not be greater than the end date!";RUS=не должна быть больше даты окончания!';
      textError02@1001 : TextConst 'ENU=must not be greater than the end time!;RUS=не должно быть больше времени окончания!';
      textError03@1002 : TextConst 'ENU=must not be less than the working date!;RUS="не должна быть меньше рабочей даты! "';

    BEGIN
    END.
  }
}

